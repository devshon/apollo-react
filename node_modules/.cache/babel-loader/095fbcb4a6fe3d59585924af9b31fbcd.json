{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar iterall_1 = require(\"iterall\");\n\nexports.withFilter = function (asyncIteratorFn, filterFn) {\n  return function (rootValue, args, context, info) {\n    var asyncIterator = asyncIteratorFn(rootValue, args, context, info);\n\n    var getNextPromise = function () {\n      return asyncIterator.next().then(function (payload) {\n        return Promise.all([payload, Promise.resolve(filterFn(payload.value, args, context, info)).catch(function () {\n          return false;\n        })]);\n      }).then(function (_a) {\n        var payload = _a[0],\n            filterResult = _a[1];\n\n        if (filterResult === true || payload.done === true) {\n          return payload;\n        }\n\n        return getNextPromise();\n      });\n    };\n\n    return _a = {\n      next: function () {\n        return getNextPromise();\n      },\n      return: function () {\n        return asyncIterator.return();\n      },\n      throw: function (error) {\n        return asyncIterator.throw(error);\n      }\n    }, _a[iterall_1.$$asyncIterator] = function () {\n      return this;\n    }, _a;\n\n    var _a;\n  };\n};","map":{"version":3,"sources":["../src/with-filter.ts"],"names":[],"mappings":";;;;;;AAAA,IAAA,SAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AAKa,OAAA,CAAA,UAAA,GAAa,UAAC,eAAD,EAA8B,QAA9B,EAAgD;AACxE,SAAO,UAAC,SAAD,EAAiB,IAAjB,EAA4B,OAA5B,EAA0C,IAA1C,EAAmD;AACxD,QAAM,aAAa,GAAG,eAAe,CAAC,SAAD,EAAY,IAAZ,EAAkB,OAAlB,EAA2B,IAA3B,CAArC;;AAEA,QAAM,cAAc,GAAG,YAAA;AACrB,aAAO,aAAa,CACjB,IADI,GAEJ,IAFI,CAEC,UAAA,OAAA,EAAO;AAAI,eAAA,OAAO,CAAC,GAAR,CAAY,CAC3B,OAD2B,EAE3B,OAAO,CAAC,OAAR,CAAgB,QAAQ,CAAC,OAAO,CAAC,KAAT,EAAgB,IAAhB,EAAsB,OAAtB,EAA+B,IAA/B,CAAxB,EAA8D,KAA9D,CAAoE,YAAA;AAAM,iBAAA,KAAA;AAAK,SAA/E,CAF2B,CAAZ,CAAA;AAGf,OALG,EAMJ,IANI,CAMC,UAAC,EAAD,EAAwB;YAAtB,OAAA,GAAA,EAAA,CAAA,CAAA,C;YAAS,YAAA,GAAA,EAAA,CAAA,CAAA,C;;AACf,YAAI,YAAY,KAAK,IAAjB,IAAyB,OAAO,CAAC,IAAR,KAAiB,IAA9C,EAAoD;AAClD,iBAAO,OAAP;AACD;;AAGD,eAAO,cAAc,EAArB;AACD,OAbI,CAAP;AAcD,KAfD;;AAiBA,WAAM,EAAA,GAAA;AACJ,MAAA,IAAI,EAAA,YAAA;AACF,eAAO,cAAc,EAArB;AACD,OAHG;AAIJ,MAAA,MAAM,EAAA,YAAA;AACJ,eAAO,aAAa,CAAC,MAAd,EAAP;AACD,OANG;AAOJ,MAAA,KAAK,EAAA,UAAC,KAAD,EAAM;AACT,eAAO,aAAa,CAAC,KAAd,CAAoB,KAApB,CAAP;AACD;AATG,KAAA,EAUJ,EAAA,CAAC,SAAA,CAAA,eAAD,CAAA,GAAA,YAAA;AACE,aAAO,IAAP;AACD,KAZG,EAaJ,EAbF;;;AAcD,GAlCD;AAmCD,CApCY","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar iterall_1 = require(\"iterall\");\nexports.withFilter = function (asyncIteratorFn, filterFn) {\n    return function (rootValue, args, context, info) {\n        var asyncIterator = asyncIteratorFn(rootValue, args, context, info);\n        var getNextPromise = function () {\n            return asyncIterator\n                .next()\n                .then(function (payload) { return Promise.all([\n                payload,\n                Promise.resolve(filterFn(payload.value, args, context, info)).catch(function () { return false; }),\n            ]); })\n                .then(function (_a) {\n                var payload = _a[0], filterResult = _a[1];\n                if (filterResult === true || payload.done === true) {\n                    return payload;\n                }\n                return getNextPromise();\n            });\n        };\n        return _a = {\n                next: function () {\n                    return getNextPromise();\n                },\n                return: function () {\n                    return asyncIterator.return();\n                },\n                throw: function (error) {\n                    return asyncIterator.throw(error);\n                }\n            },\n            _a[iterall_1.$$asyncIterator] = function () {\n                return this;\n            },\n            _a;\n        var _a;\n    };\n};\n//# sourceMappingURL=with-filter.js.map"]},"metadata":{},"sourceType":"script"}